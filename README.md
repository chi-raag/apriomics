# apriomics

A Python package for generating chemical similarity priors for Bayesian models.

## Overview

`apriomics` provides tools to:

1. Convert chemical/metabolite names to SMILES strings via ChEBI database queries
2. Generate molecular fingerprints (using MAP4)
3. Create similarity matrices for use as priors in Bayesian models

The package focuses exclusively on prior generation, leaving the Bayesian modeling implementation to the user. Example implementations of Bayesian models using these priors can be found in the `examples` directory.

## Installation

```bash
# Clone the repository
git clone https://github.com/yourusername/apriomics.git
cd apriomics

# Install the package
pip install -e .
```

## Requirements

- Python >= 3.13
- RDKit
- MAP4
- tmap
- pandas
- numpy
- requests

## Usage

### Basic Usage

```python
from chem_priors import ChemistryPriors

# Define metabolites
metabolites = ["Glucose", "Fructose", "Lactose", "Sucrose", "Maltose"]

# Create a ChemistryPriors object
priors = ChemistryPriors(dimensions=1024)

# Run the complete pipeline
priors.run_pipeline(
    metabolites=metabolites,
    output_dir="output"
)

# Access the similarity matrix
similarity_matrix = priors.similarity_matrix
```

### Using Priors with Your Own Models

The similarity matrix generated by `apriomics` can be used as a covariance kernel in various Bayesian models:

```python
# Get the kernel for use in your model
kernel = priors.get_kernel(scale=1.0)

# Use the kernel in your Bayesian model
# (See examples directory for implementation examples)
```

## Examples

The `examples` directory contains implementations showing how to use the generated priors with different Bayesian models:

1. **Gaussian Process Example**: Shows how to use the chemical similarity matrix as a kernel in a GP model.

Run the example with:

```bash
cd examples
python gp_example.py
```

## Components

- `ChemistryPriors`: Main class for generating chemical similarity priors
- Utility functions for SMILES retrieval and fingerprint generation

## How It Works

1. **SMILES Retrieval**: The package queries the ChEBI database to convert metabolite names to SMILES strings.
2. **Fingerprint Generation**: SMILES strings are converted to MAP4 fingerprints, which capture molecular structure.
3. **Similarity Matrix**: Fingerprints are compared using tmap's distance calculation to create a similarity matrix.
4. **Prior for Bayesian Models**: The similarity matrix serves as a prior in your Bayesian models.

## License

MIT License
